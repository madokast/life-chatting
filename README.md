# Life Chatting

一个融合日记记录与 AI 智能对话的人生管理应用，通过 AI 深度理解用户的生活轨迹，提供个性化的人生建议。

## 功能特性

- **📝 日记记录**：便捷撰写日记，支持附件上传，时间线展示
- **🤖 AI 智能对话**：AI 阅读用户日记，提供个性化人生建议（需自行配置 AI API Key）
- **📦 开箱即用**：无需复杂配置，直接使用核心功能，AI 功能可选择性开启
- **🔒 本地优先**：所有数据默认存储在本地，保护隐私安全，无需依赖云端服务
- **🌍 国际化支持**：内置中英文，自动检测系统语言，支持手动切换
- **📤 数据管理**：本地优先存储，支持数据导出导入，可配置 WebDAV 服务进行手动同步

## 技术实现

本项目提供两个实现版本，功能对等，用户可根据需求选择：

### 双实现方案

- **Capacitor 版本**：基于 Vite + React + TypeScript 开发
- **Flutter 版本**：基于 Flutter + Dart 开发

### 核心特性

1. **PWA 模式**：两个版本都支持 Web 和 PWA，用户可直接在浏览器中使用，可部署为静态网页，支持离线使用
2. **移动端打包**：两个版本都支持 Android 和 iOS，可安装到手机桌面
3. **原生存储**：移动端访问原生文件系统缓存多媒体文件，避免浏览器 API 的限制，保证本地存储的可靠性
4. **功能对等**：两个版本功能保持一致，用户可根据偏好选择
5. **数据互通**：两个版本使用相同的数据格式，可通过 WebDAV 同步实现数据互通

## 架构设计

### 核心功能

#### 日记记录
- **便捷记录**：像发帖一样轻松撰写日记，记录生活中的点滴
- **附件支持**：支持上传图片、文档等多种附件，丰富日记内容
- **时间线展示**：按时间轴整理展示，回顾生活轨迹

#### AI 智能对话
- **⚠️ 使用前提**：需要用户自行配置 AI API Key（支持 OpenAI、Anthropic 等）
- **配置方式**：在应用设置中输入 API Key，存储在本地 IndexedDB，不经过任何服务器
- **自然交互**：用户通过自然语言与 AI 交流，无需手动指定数据范围
- **智能工具调用**：AI 通过 Function Calling 调用工具获取数据
  - **日记查询工具**：获取最近 N 天的日记、获取最近的 N 条日记
  - **全文搜索工具**：根据关键词搜索日记内容
  - **用户画像工具**：获取 AI 维护的用户画像信息
- **用户画像**：
  - AI 自动维护一个数百到数千字的用户画像文件
  - 通过阅读用户日记和与用户交流，逐渐形成对用户的全面了解
  - 画像文件对用户不可见，仅 AI 内部使用
  - 新对话时可直接基于用户画像提供个性化建议
- **个性化建议**：基于用户画像和日记内容，提供针对性的人生建议
  - **短期规划**：帮助制定一天内的计划和任务安排
  - **中期目标**：协助设定和达成周、月度目标
  - **长期规划**：提供职业发展、人生方向等长期建议
- **持续对话**：与 AI 进行多轮对话，深入探讨人生问题

#### 国际化支持
- **多语言支持**：开发时内置中文和英文语言包
- **自动检测**：应用启动时自动根据系统语言选择对应语言
- **手动切换**：用户可在设置中手动切换语言（中文/英文）
- **可扩展性**：架构支持后续添加更多语言

### 数据管理

#### WebDAV 同步
- **⚠️ 使用前提**：需要用户自行配置 WebDAV 服务器信息
- **配置方式**：在应用设置中输入 WebDAV 服务器地址、用户名、密码等信息
- **数据加密支持**：用户可提供加密密码，数据通过对称加密方式保存到 WebDAV，避免数据泄露和公有 WebDAV 内容审核导致的数据丢失风险
- **同步方式**：仅支持手动触发，APP 提供显式的同步按钮，用户点击后触发
- **同步粒度**：最细粒度是一则日记、一条聊天消息、一个媒体文件，每个都有 UUID，当同一 UUID 在本地和云端都存在时，直接按时间最新进行覆盖，不考虑复杂的冲突解决方案
- **支持从 WebDAV 恢复数据**
- **可扩展设计**：数据同步功能进行封装设计，便于后续新增 OSS、S3 等新的数据同步方式

#### 数据导出导入
- **导出功能**：
  - 配置和文本数据导出为 JSON 文件
  - 图片等附件文件导出到 assets 文件夹
  - 所有文件打包为 ZIP 压缩包
  - 浏览器环境：直接下载 ZIP 文件
  - 移动端（PWA）：支持分享 ZIP 文件
- **导入功能**：
  - 选择 ZIP 文件进行导入
  - 导入时覆盖本地所有数据
  - 适用于数据迁移或备份恢复

### 数据存储策略

#### 数据类型
- **用户配置**：应用设置、主题偏好、API 配置等
- **日记文本**：日记内容、标签、时间戳等
- **AI 聊天文本**：与 AI 的对话历史记录
- **用户画像**：AI 自动维护的用户画像文件（数百到数千字，对用户不可见）
- **多媒体数据**：图片、文档等附件文件

#### 存储方案

- **浏览器环境**：使用 IndexedDB 存储所有数据，容量可达数百 MB
- **移动端**：
  - 文本数据：使用本地数据库（IndexedDB 或 SQLite）
  - 多媒体文件：通过原生文件系统 API 访问，容量更大更可靠

## 开发计划

### 阶段零：静态原型（HTML + CSS）

在正式开发前，先创建静态页面原型，确定前端页面的内容和样式。

#### 页面结构

- **底部导航栏（Bottom Navigation/Tab Bar）**
  - 日记页面
  - 聊天页面

- **左侧抽屉菜单（Left-side Navigation Drawer）**
  - 配置
  - 同步
  - 导出
  - 导入

#### 任务清单

- [ ] 搭建静态原型项目结构
- [ ] 实现底部导航栏组件
- [ ] 实现左侧抽屉菜单组件
- [ ] 设计日记页面布局
- [ ] 设计聊天页面布局
- [ ] 设计配置页面布局
- [ ] 响应式适配（移动端优先）

### 阶段一：Capacitor 版本（优先）

- [ ] 初始化 Capacitor 项目（Vite + React + TypeScript）
- [ ] 配置 PWA 支持
- [ ] 搭建基础 UI 框架（shadcn/ui）
- [ ] 配置国际化支持（i18next）
- [ ] 实现数据存储层（IndexedDB + @capacitor/filesystem）
- [ ] 实现日记模块（增删改查、附件上传）
- [ ] 实现 AI 聊天模块
- [ ] 实现 WebDAV 同步功能
- [ ] 实现数据导出导入功能（ZIP 打包/解压）
- [ ] 实现设置页面（语言切换、API Key、WebDAV 配置）
- [ ] 响应式设计优化
- [ ] PWA 功能测试
- [ ] Capacitor 移动端测试

### 阶段二：Flutter 版本（根据需求）

- [ ] 初始化 Flutter 项目
- [ ] 配置 Web/PWA 支持
- [ ] 搭建基础 UI 框架（Material Design）
- [ ] 配置国际化支持（flutter_localizations）
- [ ] 实现数据存储层（sqflite + path_provider）
- [ ] 实现日记模块（增删改查、附件上传）
- [ ] 实现 AI 聊天模块
- [ ] 实现 WebDAV 同步功能
- [ ] 实现数据导出导入功能（ZIP 打包/解压）
- [ ] 实现设置页面（语言切换、API Key、WebDAV 配置）
- [ ] 响应式设计优化
- [ ] Web/PWA 功能测试
- [ ] 移动端测试
